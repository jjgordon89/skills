{
  "id": "policy-engine",
  "name": "Policy Engine",
  "version": "1.0.0",
  "description": "Deterministic governance layer for tool execution — allowlists, deny patterns, risk tiers, dry-run mode, and audit logging.",
  "entry": "index.ts",
  "configSchema": {
    "type": "object",
    "properties": {
      "enabled": { "type": "boolean", "default": true },
      "dryRun": { "type": "boolean", "default": false },
      "dryRunAllowT0": { "type": "boolean", "default": true },
      "dryRunEssentialTools": {
        "type": "array",
        "items": { "type": "string" },
        "description": "Tools that always pass through dry-run mode (control plane). Prevents deadlock.",
        "default": ["message", "gateway", "session_status", "sessions_send", "sessions_list", "tts"]
      },
      "maxBlockedRetries": { "type": "number", "default": 3 },
      "riskTiers": {
        "type": "object",
        "description": "Map of toolName → 'T0'|'T1'|'T2'",
        "additionalProperties": { "type": "string", "enum": ["T0", "T1", "T2"] }
      },
      "denyPatterns": {
        "type": "object",
        "description": "Map of toolName → array of blocked argument patterns",
        "additionalProperties": {
          "type": "array",
          "items": { "type": "string" }
        }
      },
      "allowlists": {
        "type": "object",
        "description": "Map of profile name → array of allowed tool names",
        "additionalProperties": {
          "type": "array",
          "items": { "type": "string" }
        }
      },
      "routing": {
        "type": "object",
        "description": "Map of agentId → { model?, toolProfile? }",
        "additionalProperties": {
          "type": "object",
          "properties": {
            "model": { "type": "string" },
            "toolProfile": { "type": "string" }
          }
        }
      }
    }
  }
}
