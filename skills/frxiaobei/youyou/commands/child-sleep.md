---
description: 儿童睡眠管理与问题识别
arguments:
  - name: action
    description: 操作类型：record(记录睡眠)/schedule(作息管理)/problem(睡眠问题)/analysis(睡眠分析)/routine(作息建议)/history(历史)
    required: true
  - name: info
    description: 睡眠信息（就寝时间、起床时间、夜醒次数等）
    required: false
  - name: date
    description: 睡眠日期（YYYY-MM-DD，默认昨天）
    required: false
---

# 儿童睡眠管理

儿童睡眠记录、作息管理和睡眠问题识别，提供各年龄段睡眠时长参考和作息建议。

## 操作类型

### 1. 记录睡眠 - `record`

记录儿童睡眠情况。

**参数说明:**
- `info`: 睡眠信息（自然语言）
- `date`: 睡眠日期（可选，默认昨天）

**示例:**
```
/child-sleep record 21点睡 7点起 醒了1次
/child-sleep record bedtime 21:00 wake 7:00 wakeup 1
```

**执行步骤:**

#### 1. 读取儿童基础信息

从 `data/profile.json` 读取儿童信息。如缺少，提示设置。

#### 2. 根据年龄确定睡眠标准

| 年龄 | 推荐总睡眠 | 夜间睡眠 | 白天小睡 | 小睡次数 |
|------|------------|----------|----------|----------|
| 0-3月 | 14-17小时 | 8-10小时 | 6-7小时 | 3-4次 |
| 4-12月 | 12-16小时 | 9-12小时 | 3-4小时 | 2-3次 |
| 1-2岁 | 11-14小时 | 10-12小时 | 1.5-3小时 | 1-2次 |
| 3-5岁 | 10-13小时 | 10-12小时 | 0-2小时 | 0-1次 |
| 6-12岁 | 9-12小时 | 9-12小时 | 0 | 0次 |
| 13-18岁 | 8-10小时 | 8-10小时 | 0 | 0次 |

#### 3. 生成睡眠记录报告

**正常睡眠示例:**
```
✅ 睡眠记录已保存

睡眠信息：
━━━━━━━━━━━━━━━━━━━━━━━━━━
儿童：小明
年龄：2岁5个月
睡眠日期：2025年1月13日夜间

就寝时间：21:00
入睡时间：21:30
起床时间：07:00
总睡眠时长：9.5小时

夜间情况：
━━━━━━━━━━━━━━━━━━━━━━━━━━
夜醒次数：1次
夜醒时长：约10分钟
夜醒原因：口渴/需要安慰

入睡方式：自主入睡
睡眠质量：良好 ✅

睡眠评估：
━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 睡眠时长正常（推荐10-12小时）
✅ 入睡时间合适
✅ 夜醒次数正常
✅ 睡眠质量良好

白天小睡：
━━━━━━━━━━━━━━━━━━━━━━━━━━
小睡次数：1次
小睡时长：约2小时
总睡眠（含小睡）：约11.5小时 ✅

作息建议：
━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 保持当前作息时间
✅ 建立固定的睡前程序
✅ 营造良好的睡眠环境

⚠️ 重要提示：
━━━━━━━━━━━━━━━━━━━━━━━━━━
每个孩子睡眠需求不同，
关键是观察孩子的精神状态。

如精神好、发育正常，
说明睡眠充足。

数据已保存
```

**睡眠不足示例:**
```
⚠️ 睡眠不足提醒

睡眠信息：
━━━━━━━━━━━━━━━━━━━━━━━━━━
儿童：小明
年龄：2岁5个月
睡眠日期：2025年1月13日夜间

就寝时间：22:00
入睡时间：23:00
起床时间：06:30
总睡眠时长：7.5小时

夜间情况：
━━━━━━━━━━━━━━━━━━━━━━━━━━
夜醒次数：3次
夜醒时长：共约1小时
入睡困难：是（30分钟）

睡眠评估：
━━━━━━━━━━━━━━━━━━━━━━━━━━
⚠️ 睡眠时长不足（推荐10-12小时）
⚠️ 就寝时间偏晚
⚠️ 入睡困难
⚠️ 夜醒频繁

可能影响：
━━━━━━━━━━━━━━━━━━━━━━━━━━
• 白天精神不佳
• 情绪烦躁
• 食欲下降
• 免疫力下降

改善建议：
━━━━━━━━━━━━━━━━━━━━━━━━━━

🕐 调整作息
   • 提前30分钟开始睡前程序
   • 固定就寝时间（20:30-21:00）

🌙 优化睡前程序
   • 停止屏幕时间1小时前
   • 安静活动（绘本、温水澡）
   • 固定程序顺序

🛏️ 改善睡眠环境
   • 室温20-22℃
   • 保持黑暗安静
   • 舒适的寝具

⚠️ 如持续睡眠不足：
━━━━━━━━━━━━━━━━━━━━━━━━━━
建议咨询儿科医生，
排除睡眠障碍等问题。

使用 /child-sleep problem 查看常见睡眠问题
数据已保存
```

---

### 2. 作息管理 - `schedule`

管理和记录儿童作息时间表。

**示例:**
```
/child-sleep schedule
/child-sleep schedule set 21:00 7:30
```

**输出示例:**
```
📅 儿童作息时间表

儿童：小明（2岁5个月）

当前作息：
━━━━━━━━━━━━━━━━━━━━━━━━━━

早晨：
  07:00  起床
  07:30  早餐
  08:00  早晨活动

上午：
  09:30  上午加餐（如需要）
  10:00  户外活动/游戏
  11:30  午餐准备

中午：
  12:00  午餐
  12:30  午餐后安静活动
  13:00  午睡时间

下午：
  15:00  起床/下午加餐
  15:30  下午活动
  17:30  晚餐准备

晚上：
  18:00  晚餐
  18:30  晚餐后亲子时间
  19:30  洗澡/洗漱
  20:00  睡前程序开始
  20:30  睡前绘本
  21:00  就寝

睡眠时长统计：
━━━━━━━━━━━━━━━━━━━━━━━━━━
夜间睡眠：10小时（21:00-07:00）
白天小睡：2小时（13:00-15:00）
总睡眠：12小时 ✅

使用 /child-sleep schedule set 可修改作息
使用 /child-sleep routine 查看睡前程序建议
```

---

### 3. 睡眠问题 - `problem`

识别和处理常见睡眠问题。

**示例:**
```
/child-sleep problem
/child-sleep problem 入睡困难
```

**输出示例（总览）:**
```
😴 常见儿童睡眠问题

儿童：小明（2岁5个月）

睡眠问题自查：
━━━━━━━━━━━━━━━━━━━━━━━━━━

□ 入睡困难
   表现：就寝后30分钟以上不能入睡
   可能原因：作息不规律、过度疲劳、睡眠环境
   建议：固定作息、提前开始睡前程序

□ 夜间频繁醒来
   表现：每晚醒来2次以上
   可能原因：饥饿、不适、习惯性醒来
   建议：排查原因、逐渐减少干预

□ 早起
   表现：早晨6点前醒来且无法再睡
   可能原因：睡眠环境、作息安排
   建议：调整就寝时间、遮挡晨光

□ 拒绝午睡
   表现：白天不愿意午睡
   可能原因：发育阶段、精力旺盛
   建议：保持安静时间，不一定强制午睡

□ 夜惊/噩梦
   表现：夜间惊恐哭闹
   可能原因：发育阶段、过度疲劳
   建议：安抚、不要唤醒

□ 梦游/说梦话
   表现：夜间异常行为
   可能原因：遗传、疲劳
   建议：安全防护、不要唤醒

使用 /child-sleep problem [具体问题] 查看详细处理方法
```

**输出示例（入睡困难）:**
```
📋 入睡困难处理

问题：入睡困难
年龄：2岁5个月

可能原因：
━━━━━━━━━━━━━━━━━━━━━━━━━━
1. 作息不规律
   就寝时间不固定，打乱生物钟

2. 过度疲劳
   活动量过大或错过最佳睡眠窗口

3. 睡前过度兴奋
   屏幕时间、激烈游戏

4. 分离焦虑
   害怕与父母分开

5. 舒适度问题
   温度、衣物、尿布等

处理建议：
━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ 建立固定作息
   • 每天同一时间开始睡前程序
   • 周末也保持相同作息

✅ 优化睡前程序
   • 提前30-60分钟开始
   • 固定活动顺序：洗澡→绘本→安抚
   • 程序时间20-30分钟

✅ 创造良好环境
   • 室温20-22℃
   • 保持安静昏暗
   • 使用白噪音

✅ 减少睡前刺激
   • 停止屏幕时间1小时前
   • 避免激烈游戏
   • 选择安静活动

✅ 建立安全感
   • 固定的安抚物品
   • 父母的陪伴和安抚
   • 离开时告知"妈妈就在旁边"

❌ 避免的做法：
━━━━━━━━━━━━━━━━━━━━━━━━━━
• 不要用"再不睡就..."威胁
• 不要频繁进房间干预
• 不要抱睡/摇睡入睡
• 不要睡前训斥孩子

⚠️ 何时就医：
━━━━━━━━━━━━━━━━━━━━━━━━━━
如尝试上述方法2-4周无效，
或伴有打鼾、呼吸暂停等症状，
建议咨询儿科医生。

使用 /child-sleep routine 查看睡前程序建议
```

---

### 4. 睡眠分析 - `analysis`

分析睡眠模式和趋势。

**示例:**
```
/child-sleep analysis
/child-sleep analysis week
```

**输出示例:**
```
📊 睡眠分析报告

儿童：小明（2岁5个月）
分析周期：最近7天

睡眠统计：
━━━━━━━━━━━━━━━━━━━━━━━━━━
平均就寝时间：21:15
平均起床时间：07:10
平均睡眠时长：9小时50分

睡眠时长分布：
━━━━━━━━━━━━━━━━━━━━━━━━━━
周一  9小时30分  ✅
周二  10小时15分 ✅
周三  9小时45分  ✅
周四  8小时30分  ⚠️
周五  9小时      ✅
周六  10小时30分 ✅
周日  10小时     ✅

睡眠质量评估：
━━━━━━━━━━━━━━━━━━━━━━━━━━
优秀：3天（43%）
良好：3天（43%）
欠佳：1天（14%）

夜醒统计：
━━━━━━━━━━━━━━━━━━━━━━━━━━
平均夜醒次数：0.7次/晚
无夜醒：4天
夜醒1次：2天
夜醒2次：1天

趋势分析：
━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 睡眠时长总体稳定在推荐范围
✅ 就寝时间相对固定
✅ 周末睡眠时间更长
⚠️ 周四睡眠偏短，可能因为外出活动

改善空间：
━━━━━━━━━━━━━━━━━━━━━━━━━━
• 尽量保持每天作息一致
• 提高睡眠稳定性

使用 /child-sleep schedule 查看作息安排
```

---

### 5. 作息建议 - `routine`

提供睡前程序和作息建议。

**示例:**
```
/child-sleep routine
/child-sleep routine 2岁
```

**输出示例（2-3岁）:**
```
🌙 睡前程序建议

儿童：小明（2岁5个月）

推荐睡前程序（20-30分钟）：
━━━━━━━━━━━━━━━━━━━━━━━━━━

提前1小时（20:00）
├── 停止屏幕时间
├── 停止激烈活动
└── 转入安静模式

提前30分钟（20:30）
├── 收拾玩具
├── 上厕所、喝水
└── 准备洗澡

洗澡时间（20:40）
├── 温水浴（10-15分钟）
└── 换上睡衣/尿布

安静活动（21:00）
├── 睡前绘本（2-3本）
├── 轻声聊天/唱歌
└── 道晚安仪式

就寝（21:15-21:30）
├── 上床、盖被子
├── 最后的安抚
└── 道晚安、离开房间

睡前程序要点：
━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ 每天保持相同顺序
✅ 提前开始，不要匆忙
✅ 活动由动转静
✅ 父母陪伴但不过度干预
✅ 固定的结束仪式

❌ 避免的事项：
━━━━━━━━━━━━━━━━━━━━━━━━━━
❌ 睡前看电视/手机
❌ 玩兴奋的游戏
❌ 吃太多零食
❌ 喝太多水
❌ 睡前训斥孩子

睡眠环境检查：
━━━━━━━━━━━━━━━━━━━━━━━━━━

温度：20-22℃（以手摸后颈温热无汗为佳）
湿度：50-60%
光线：昏暗或全黑
声音：安静或使用白噪音
寝具：舒适、安全
安全：无窒息风险物品

⚠️ 安全提示：
━━━━━━━━━━━━━━━━━━━━━━━━━━
1岁后：可以使用小薄毯
2岁后：可以使用枕头
避免：大玩具、厚毯子、软枕头

数据已保存
```

---

### 6. 历史记录 - `history`

显示睡眠历史记录。

**示例:**
```
/child-sleep history
/child-sleep history 14
```

---

## 数据结构

### 主文件：data/child-sleep-tracker.json

```json
{
  "created_at": "2025-01-14T00:00:00.000Z",
  "last_updated": "2025-01-14T10:00:00.000Z",

  "child_profile": {
    "child_id": "child_20200101",
    "name": "小明",
    "birth_date": "2020-01-01",
    "gender": "male"
  },

  "sleep_records": [
    {
      "date": "2025-01-13",
      "age": "2y5m",
      "age_months": 29,

      "night_sleep": {
        "bedtime": "21:00",
        "fall_asleep_time": "21:30",
        "wake_time": "07:00",
        "total_sleep_hours": 9.5,
        "sleep_efficiency": "good"
      },

      "night_wakeups": {
        "count": 1,
        "durations_minutes": [10],
        "reasons": ["口渴"],
        "intervention_required": false
      },

      "day_sleep": {
        "naps": 1,
        "nap_duration_hours": 2,
        "total_nap_sleep": 2
      },

      "total_sleep": {
        "hours": 11.5,
        "within_recommended": true,
        "recommended_range": "11-14"
      },

      "sleep_quality": "good",
      "notes": ""
    }
  ],

  "sleep_schedule": {
    "target_bedtime": "21:00",
    "target_wake_time": "07:00",
    "nap_time": "13:00-15:00"
  },

  "bedtime_routine": [
    "洗澡",
    "绘本",
    "安抚"
  ],

  "sleep_problems": {
    "night_terrors": false,
    "bedwetting": false,
    "sleep_walking": false,
    "teeth_grinding": false,
    "snoring": false,
    "mouth_breathing": false
  },

  "statistics": {
    "total_records": 1,
    "average_sleep_hours": 11.5,
    "average_bedtime": "21:00",
    "average_wake_time": "07:00",
    "sleep_quality_distribution": {
      "excellent": 0,
      "good": 1,
      "fair": 0,
      "poor": 0
    }
  }
}
```

---

## 各年龄段睡眠参考

### 新生儿（0-3月）
- 总睡眠：14-17小时
- 模式：吃睡模式，无固定作息
- 特点：昼夜不分

### 婴儿（4-12月）
- 总睡眠：12-16小时
- 夜间：9-12小时
- 小睡：2-3次，共3-4小时
- 建议：开始建立作息

### 幼儿（1-3岁）
- 总睡眠：11-14小时
- 夜间：10-12小时
- 小睡：1-2次，共2-3小时
- 建议：固定作息和睡前程序

### 学龄前（3-6岁）
- 总睡眠：10-13小时
- 夜间：10-12小时
- 小睡：0-1次，共0-2小时
- 建议：逐渐取消午睡

### 学龄期（6-12岁）
- 总睡眠：9-12小时
- 建议：保证充足睡眠，支持学习

### 青春期（13-18岁）
- 总睡眠：8-10小时
- 建议：关注睡眠不足问题

---

## 错误处理

| 场景 | 错误消息 | 建议 |
|------|---------|------|
| 缺少儿童档案 | 未找到儿童档案<br>请先设置 /profile child-name | 引导设置基础信息 |
| 时间不合理 | 就寝时间不能晚于起床时间 | 验证输入 |
| 睡眠时长异常 | 睡眠时长超出合理范围 | 确认输入 |

---

## 医学安全原则

### ⚠️ 安全红线

1. **不做睡眠障碍诊断**
2. **不推荐睡眠药物**
3. **不处理呼吸暂停等严重问题**

### ✅ 系统能做到的

- 睡眠记录与追踪
- 睡眠模式分析
- 作息建议
- 常见问题指导

---

## 示例用法

```
# 记录睡眠
/child-sleep record 21点睡 7点起
/child-sleep record bedtime 21:00 wake 7:00 wakeup 1

# 作息管理
/child-sleep schedule

# 睡眠问题
/child-sleep problem
/child-sleep problem 入睡困难

# 睡眠分析
/child-sleep analysis

# 作息建议
/child-sleep routine

# 查看历史
/child-sleep history
```

---

## 重要提示

本系统仅供睡眠记录和建议参考，**不能替代专业医疗诊断**。

如出现以下情况，**请咨询儿科医生**：
- 打鼾伴有呼吸暂停
- 夜间频繁惊恐哭闹
- 白天过度嗜睡
- 睡眠中异常行为
- 长期严重失眠

数据已保存到本地，不上传云端。
