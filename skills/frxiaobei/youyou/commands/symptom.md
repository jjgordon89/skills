---
description: 记录身体不适感和症状
arguments:
  - name: action
    description: 操作类型：add(记录症状)/history(历史记录)/status(症状统计)
    required: true
  - name: description
    description: 症状描述（自然语言描述不适感受）
    required: false
  - name: date
    description: 症状日期（格式：YYYY-MM-DD，默认今天）
    required: false
---

# 身体不适感记录

记录日常身体不适和症状，自动转换为标准医学记录并提供就医建议。

## 操作类型

### 1. 记录症状 - `add`

记录身体不适感受，自动转换为结构化医学记录。

**参数说明：**
- `description`: 症状描述（必填），用自然语言描述不适感受
- `date`: 症状发生日期（可选），格式 YYYY-MM-DD，默认为今天

**示例：**
```
/symptom add 头疼
/symptom add 胃疼 早上开始 2025-12-30
/symptom add 发烧38度 伴有咳嗽
/symptom add 胸闷气短 持续2小时
```

### 2. 查看历史 - `history`

查看所有症状记录。

**示例：**
```
/symptom history
/symptom history recent 10
```

### 3. 症状统计 - `status`

查看症状统计分析。

**示例：**
```
/symptom status
```

## 执行步骤

### 记录症状 (add)

#### 1. 解析用户描述

从自然语言描述中提取以下信息：

**基本信息（自动提取）：**
- **症状名称**：标准医学术语
- **发生时间**：具体时间点或时间段
- **持续时间**：症状持续了多久
- **严重程度**：轻度/中度/重度
- **身体部位**：症状发生的具体位置

**伴随症状（识别）：**
- 相关症状列表
- 全身症状（发热、乏力等）

**诱因和缓解因素（提取）：**
- 诱发因素：运动、饮食、情绪、环境等
- 缓解因素：休息、用药、体位改变等

**其他信息：**
- 症状特点：性质、频率、进展等
- 既往史：是否曾出现类似症状

#### 2. 医学标准化转换

将通俗描述转换为标准医学术语：

| 通俗描述 | 医学术语 |
|---------|---------|
| 头疼 | 头痛/头痛 |
| 胃疼 | 胃痛/上腹痛 |
| 心慌 | 心悸 |
| 气短 | 呼吸困难 |
| 拉肚子 | 腹泻 |
| 便秘 | 便秘 |
| 恶心 | 恶心 |
| 吐 | 呕吐 |
| 头晕 | 头晕/眩晕 |

#### 3. 症状分类

按系统分类：

- **呼吸系统**：咳嗽、咳痰、呼吸困难、胸痛等
- **心血管系统**：心悸、胸闷、水肿等
- **消化系统**：腹痛、恶心、呕吐、腹泻、便秘等
- **神经系统**：头痛、头晕、失眠、抽搐等
- **泌尿系统**：尿频、尿急、尿痛、血尿等
- **内分泌系统**：多饮、多尿、体重变化等
- **肌肉骨骼**：关节痛、肌肉痛、活动受限等
- **全身症状**：发热、乏力、消瘦等

#### 4. 严重程度评估

**轻度（1级）：**
- 症状轻微，不影响日常活动
- 无需立即处理
- 可自行观察

**中度（2级）：**
- 症状明显，部分影响日常活动
- 需要休息或简单处理
- 建议观察或门诊就医

**重度（3级）：**
- 症状严重，严重影响日常活动
- 需要立即处理
- 建议尽快就医

**危急（4级）：**
- 危及生命的症状
- 需要紧急就医
- 建议立即就医或拨打急救电话

#### 5. 就医建议评估

**立即就医（拨打120或急救）：**
- 胸痛或胸闷，特别是伴有出汗、呼吸困难
- 突然严重头痛
- 呼吸困难或窒息感
- 意识模糊或昏厥
- 严重外伤或大出血
- 急性腹痛（特别是老年人）
- 突然无法说话或肢体无力

**尽快就医（今天或明天）：**
- 持续高烧超过3天
- 严重呕吐或腹泻导致脱水
- 持续加重的疼痛
- 无法解释的体重下降
- 持续的疲劳或虚弱
- 黄疸（皮肤或眼睛发黄）

**门诊就医（1周内）：**
- 轻中度症状持续超过1周
- 反复出现的症状
- 需要进一步检查的症状

**居家观察：**
- 轻度症状，时间短
- 症状逐渐好转
- 无加重趋势

#### 6. 保存记录

**文件路径格式：**
`data/症状记录/YYYY-MM/YYYY-MM-DD_主要症状.json`

**JSON 数据结构：**
```json
{
  "id": "20251231123456789",
  "record_date": "2025-12-31",
  "symptom_date": "2025-12-31",
  "original_input": "用户原始输入",

  "standardized": {
    "main_symptom": "头痛",
    "category": "神经系统",
    "body_part": "头部",
    "severity": "轻度",
    "severity_level": 1,
    "characteristics": "胀痛感",
    "onset_time": "2025-12-31T10:00:00",
    "duration": "2小时",
    "frequency": "首次出现"
  },

  "associated_symptoms": [
    {
      "name": "恶心",
      "present": true
    },
    {
      "name": "呕吐",
      "present": false
    }
  ],

  "triggers": {
    "possible_causes": ["睡眠不足", "精神紧张"],
    "aggravating_factors": [],
    "relieving_factors": ["休息后略缓解"]
  },

  "medical_assessment": {
    "urgency": "observation",
    "urgency_level": 1,
    "recommendation": "居家观察",
    "advice": "建议充分休息，保证充足睡眠。如症状加重或持续超过24小时，建议就医。",
    "red_flags": []
  },

  "follow_up": {
    "needs_follow_up": false,
    "follow_up_date": null,
    "improvement": null
  },

  "metadata": {
    "created_at": "2025-12-31T12:34:56.789Z",
    "last_updated": "2025-12-31T12:34:56.789Z"
  }
}
```

#### 7. 输出确认

```
✅ 症状记录已保存

症状信息：
━━━━━━━━━━━━━━━━━━━━━━━━━━
主要症状：头痛（轻度）
症状分类：神经系统
发生时间：今天 10:00
持续时间：2小时
症状特点：胀痛感

伴随症状：
━━━━━━━━━━━━━━━━━━━━━━━━━━
✓ 恶心
✗ 呕吐

可能诱因：
━━━━━━━━━━━━━━━━━━━━━━━━━━
• 睡眠不足
• 精神紧张

医学建议：
━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 建议等级：居家观察

💡 建议：
建议充分休息，保证充足睡眠。如症状加重或持续超过24小时，建议就医。

⚠️ 警示信号：
如出现以下情况请立即就医：
• 头痛突然加重
• 伴有发热、颈部僵硬
• 出现视力模糊或意识改变
• 头痛不同于以往经历

数据已保存至：data/症状记录/2025-12/2025-12-31_头痛.json
```

### 查看历史 (history)

**输出格式：**
```
📋 症状历史记录

2025年12月 (共3次记录)
━━━━━━━━━━━━━━━━━━━━━━━━━━
12-31  头痛（轻度）            神经系统
12-30  腹痛（中度）            消化系统
12-28  发热（中度）            全身症状

2025年11月 (共2次记录)
━━━━━━━━━━━━━━━━━━━━━━━━━━
11-15  咳嗽（轻度）            呼吸系统
11-10  关节痛（中度）          肌肉骨骼

总计：5次记录
```

### 症状统计 (status)

**输出格式：**
```
📊 症状统计分析

本月概况：
━━━━━━━━━━━━━━━━━━━━━━━━━━
记录次数：5次
最常见症状：头痛（2次）
主要系统：神经系统

系统分布：
━━━━━━━━━━━━━━━━━━━━━━━━━━
神经系统：  2次 (40%)
消化系统：  1次 (20%)
呼吸系统：  1次 (20%)
全身症状：  1次 (20%)

严重程度：
━━━━━━━━━━━━━━━━━━━━━━━━━━
轻度：  3次
中度：  2次
重度：  0次

趋势：
━━━━━━━━━━━━━━━━━━━━━━━━━━
本周较上周：新增2次
最频繁：头痛
```

## 智能识别规则

### 严重程度自动判断

**重度症状特征：**
- 关键词："剧痛"、"难以忍受"、"非常严重"
- 影响活动："无法工作"、"不能活动"、"卧床"
- 持续时间：持续数天无缓解

**轻度症状特征：**
- 关键词："有点"、"轻微"、"偶尔"
- 影响活动：不影响日常活动
- 持续时间：短时间，可自行缓解

### 时间识别

**时间点：** "今天早上"、"昨晚8点"、"2025-12-30"
**时间段：** "持续2小时"、"从昨天开始"、"断断续续一周"
**频率：** "每天"、"偶尔"、"频繁"

### 身体部位识别

**头部：** 头疼、头晕、眼花、耳鸣
**胸部：** 胸闷、胸痛、心慌
**腹部：** 胃疼、肚子疼、腹泻
**四肢：** 腿疼、胳膊疼、关节痛
**全身：** 发热、乏力、全身酸痛

## 危险信号警示

以下症状需要特别关注并标注为红色警示：

**心血管危急征象：**
- 胸痛或胸闷压迫感
- 放射至左肩、手臂、下颌的疼痛
- 伴有出汗、恶心、呼吸困难

**脑血管危急征象：**
- 突然剧烈头痛
- 言语不清或理解困难
- 肢体无力或麻木
- 视力模糊或复视
- 意识障碍

**呼吸系统危急征象：**
- 严重呼吸困难
- 窒息感
- 口唇发紫
- 呼吸急促（>30次/分）

**消化系统危急征象：**
- 急性剧烈腹痛
- 呕血或黑便
- 腹部板样强直

**全身危急征象：**
- 高热超过39°C持续不退
- 意识模糊或嗜睡
- 严重脱水征象

## 数据结构更新

在全局索引 `data/index.json` 中添加：

```json
{
  "symptom_records": [
    {
      "id": "20251231123456789",
      "date": "2025-12-31",
      "main_symptom": "头痛",
      "category": "神经系统",
      "severity_level": 1,
      "urgency_level": 1,
      "file_path": "症状记录/2025-12/2025-12-31_头痛.json"
    }
  ]
}
```

## 注意事项

- 本系统仅供症状记录和初步评估，不能替代专业医疗诊断
- 如有危急症状，应立即就医而非记录症状
- 定期查看症状统计，发现潜在健康问题
- 所有数据仅保存在本地
- 建议与医生分享症状记录以便诊断

## 示例用法

```
# 记录头痛
/symptom add 头疼

# 记录发热伴随症状
/symptom add 发烧38度伴有咳嗽嗓子疼

# 记录胸痛（会触发危急警示）
/symptom add 胸闷气短持续半小时

# 记录腹痛
/symptom add 胃疼昨天晚上开始的

# 查看历史
/symptom history

# 查看统计
/symptom status
```

## 错误处理

- **描述为空**: "请提供症状描述，例如：/symptom add 头疼"
- **日期格式错误**: "日期格式错误，请使用 YYYY-MM-DD 格式"
- **无记录**: "暂无症状记录"
- **危急症状**: "⚠️ 检测到可能危急的症状，建议立即就医而非仅记录症状。请拨打120或前往最近医院急诊。"
